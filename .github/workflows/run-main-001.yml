name: Run main.py on schedule

on:
  schedule:
    # every 5 minutes (UTC)
    - cron: "*/5 * * * *"
  workflow_dispatch: {}

jobs:
    scrape:
        env:
            PY_COLORS: "1"
            DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
        runs-on: macos-latest

        steps:
        - uses: actions/checkout@v6
        - name: Set up Python
          uses: actions/setup-python@v6
          with:
            python-version: "3.13.3"
            cache: "pip"
        - name: Create venv and activate
          run: |
            python -m venv .venv
            source .venv/bin/activate
        - name: Install dependencies
          run: |
            pip install -r requirements.txt
        - name: Install chromedriver
          run: |
            seleniumbase install chromedriver
        - name: Run main.py
          run: |
            python main.py